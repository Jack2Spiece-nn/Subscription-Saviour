# üöÄ Deployment Guide - Subscription Savor Bot

This guide will help you deploy the Subscription Savor Bot on Render's **free plan** successfully.

## ‚úÖ Pre-Deployment Checklist

### 1. Get Your Telegram Bot Token
1. Start a chat with [@BotFather](https://t.me/BotFather) on Telegram
2. Send `/newbot` command
3. Choose a name and username for your bot
4. **Copy and save the bot token** - you'll need this for deployment

### 2. Get Your Telegram User ID
1. Start a chat with [@userinfobot](https://t.me/userinfobot) on Telegram  
2. Send any message
3. **Copy your user ID** - this gives you admin access to the bot

### 3. Fork This Repository
1. Click the "Fork" button on GitHub to create your own copy
2. You'll deploy from your forked repository

## üåü One-Click Deployment

### Step 1: Deploy to Render
1. **Click the Deploy button:** [![Deploy to Render](https://render.com/images/deploy-to-render-button.svg)](https://render.com/deploy)

2. **Connect your GitHub account** if you haven't already

3. **Select your forked repository** from the list

### Step 2: Configure Environment Variables

You'll need to set these **required** environment variables:

| Variable | Value | Where to Get It |
|----------|-------|-----------------|
| `TELEGRAM_BOT_TOKEN` | Your bot token from step 1 | [@BotFather](https://t.me/BotFather) |
| `WEBHOOK_URL` | Your Render app URL | Will be provided after deployment |
| `ADMIN_USER_ID` | Your Telegram user ID from step 2 | [@userinfobot](https://t.me/userinfobot) |

**Note:** Other variables like `DATABASE_URL`, `REDIS_URL`, and `SECRET_KEY` will be automatically generated by Render.

### Step 3: Deploy and Get Your App URL

1. Click **"Create"** to start the deployment
2. Wait for all services to deploy (this may take 5-10 minutes)
3. Once deployed, you'll see your app URL (something like `https://subscription-savor-bot-abc123.onrender.com`)

### Step 4: Set the Webhook URL

1. Go back to your Render dashboard
2. Find your web service (`subscription-savor-bot`)
3. Go to **Environment** tab
4. Update the `WEBHOOK_URL` variable with your actual app URL
5. Click **Save Changes** - this will redeploy your service

## üîß Post-Deployment Setup

### Test Your Bot
1. Find your bot on Telegram using the username you created
2. Send `/start` to your bot
3. You should receive a welcome message

### Set Up the Webhook (Automatic)
The webhook should be set up automatically, but if you need to do it manually:
1. Visit `https://your-app-url.onrender.com/set_webhook` (replace with your actual URL)
2. You should see a success message

### Verify Everything is Working
1. Visit `https://your-app-url.onrender.com/` to see the health check
2. Visit `https://your-app-url.onrender.com/webhook_info` to verify webhook setup
3. Try adding a subscription through your bot

## üÜì Free Plan Limitations

Your bot is deployed on Render's free plan with these limitations:

### Services Included
- ‚úÖ **Web Service** (free): Handles Telegram webhooks
- ‚úÖ **Worker Service** (free): Processes background tasks and reminders  
- ‚úÖ **PostgreSQL Database** (free): Stores user data and subscriptions
- ‚úÖ **Redis Cache** (free): Handles background job queue

### Free Plan Limits
- **Web Service**: Goes to sleep after 15 minutes of inactivity, takes ~30 seconds to wake up
- **Database**: 1GB storage, 97 hours/month runtime
- **Redis**: 25MB storage, 30 connections max
- **Worker**: 750 hours/month runtime

### Bot Feature Limits (by design)
- **Free Users**: Up to 3 active subscriptions, 2-day advance reminders
- **Pro Users**: Unlimited subscriptions, custom reminder timing, notes, savings tracker

## üîÑ Keeping Your Bot Active

Since free services sleep after 15 minutes of inactivity:

1. **Use a monitoring service** like [UptimeRobot](https://uptimerobot.com/) (free) to ping your app every 30 minutes
2. **Set up a simple cron job** to ping `https://your-app-url.onrender.com/` periodically
3. **Users will experience a slight delay** (~30 seconds) when messaging a sleeping bot

## üêõ Troubleshooting

### Bot Not Responding
1. Check if your services are all running in the Render dashboard
2. Verify webhook is set correctly: visit `/webhook_info` endpoint
3. Check logs in Render dashboard for error messages

### Webhook Issues
- Manually set webhook: `POST` to `/set_webhook` endpoint
- Verify `WEBHOOK_URL` environment variable is correct
- Check Telegram bot token is valid

### Database Errors
- Ensure PostgreSQL service is running
- Database tables are created automatically on first run
- Check worker service logs for Celery connection issues

### Redis Connection Issues
- Verify Redis service is running
- Check worker service logs
- Redis should be accessible via internal network only (`ipAllowList: []`)

## üìä Monitoring Your Deployment

### Health Checks
- **Main app**: `https://your-app-url.onrender.com/`
- **Bot stats**: `https://your-app-url.onrender.com/stats`
- **Webhook info**: `https://your-app-url.onrender.com/webhook_info`

### Logs
Check the logs in your Render dashboard:
- **Web Service logs**: For webhook and user interaction issues
- **Worker Service logs**: For background task and reminder issues
- **Database logs**: For connection and query issues

## üîí Security Notes

- Your bot token and admin user ID are stored securely as environment variables
- Redis is configured for internal connections only
- Database uses Render's secure PostgreSQL service
- All services communicate over Render's private network

## üí∞ Upgrade Considerations

If you outgrow the free plan:
- **Starter Plan ($7/month)**: Always-on services, more database storage
- **Pro Plan ($25/month)**: Better performance, more resources
- **Custom Plans**: For high-traffic bots

## üÜò Getting Help

If you encounter issues:
1. Check the logs in your Render dashboard
2. Review this troubleshooting guide
3. Check the main README.md for additional configuration details
4. Create an issue on GitHub with your error logs

---

**üéâ Congratulations! Your Subscription Savor Bot should now be running on Render's free plan!**

Users can start using it immediately to track their subscription deadlines and get timely reminders.